<!DOCTYPE html><html lang='en'><head><meta charset='utf-8'><meta name='description' content='Notes on customizing and developing on the Plan 9 operating system.'/><meta name='thumbnail' content='https://wiki.xxiivv.com/media/services/thumbnail.jpg' /><link rel='alternate' type='application/rss+xml' title='RSS Feed' href='../links/rss.xml' /><link rel='stylesheet' type='text/css' href='../links/main.css'><link rel='shortcut icon' type='image/png' href='../media/services/icon.png'><title>XXIIVV — plan9 c</title></head><body><header><a href='home.html'><img src='../media/icon/logo.svg' alt='XXIIVV'></a></header><nav><ul><li><a href='plan9.html'>plan9/</a></li><li><a href='linux.html'>linux</a></li><li><a href='ansi_c.html'>ansi c</a></li></ul><ul><li><a href='rio.html'>rio</a></li><li><a href='acme.html'>acme</a></li><li><a href='plan9_c.html'>plan9 c/</a></li><li><a href='plan9_clock.html'>plan9 clock</a></li></ul><ul></ul></nav><main><figure><img src='../media/diary/722.jpg' alt='Plan9 Draw picture'/><figcaption>20P05 — Plan9 Draw</figcaption></figure><h2>Notes on customizing and developing on the Plan 9 operating system.</h2><p>Collected notes on writing GUI applications and modifying the look and feel of the <a href='plan9.html'>Plan9</a> operating system. For a more complete example, see the <a href='plan9_clock.html'>Plan9 Clock</a>.</p><h3>Plan 9 C Example</h3>

<pre>
#include &lt;u.h&gt;
#include &lt;libc.h&gt;

void
main()
{
  print("hello, world\n");
  exits(0);
}
</pre>

<h3>Compilers</h3>

<p>To convert source to an executable binary is a two-step process. First run the compiler, <code>5c</code>, on the source, say <code>file.c</code>, to generate an object file <code>file.5</code>. Then run the loader, <code>5l</code>, to generate an executable <code>5.out</code> that may be run(on an ARM machine):</p>

<pre>
2c file.c
2l file.2 # Or, 2l file file.2
2.out
</pre>

<p>The loader automatically links with whatever libraries the program needs, usually including the standard C library as defined by <code>libc.h</code>. The compiler does not generate an executable automatically; the output of the compiler must be given to the loader. Since most compilation is done under the control of mk, this is rarely an inconvenience.</p>

<table border='1'>
  <tr><td></td><td>compiler</td><td>linker</td><td></td></tr>
  <tr><td>SPARC</td><td>kc</td><td>kl</td><td>ka</td></tr>
  <tr><td>PowerPC</td><td>qc</td><td>ql</td><td>qa</td></tr>
  <tr><td>MIPS</td><td>vc</td><td>vl</td><td>va</td></tr>
  <tr><td>ARM</td><td>5c</td><td>5l</td><td>5a</td></tr>
  <tr><td>AMD64</td><td>6c</td><td>6l</td><td>6a</td></tr>
  <tr><td>Intel386</td><td>8c</td><td>8l</td><td>8a</td></tr>
  <tr><td>PowerPC64bits</td><td>9c</td><td>9l</td><td>9a</td></tr>
</table>

<h3>Plan 9 Mouse Example</h3>

<pre>
#include &lt;u.h&gt;
#include &lt;libc.h&gt;
#include &lt;draw.h&gt;
#include &lt;event.h&gt;
#include &lt;keyboard.h&gt;

void eresized(int new) {
	if (new &&getwindow(display, Refnone) < 0)
		sysfatal("can't reattach to window");
}

void main(int argc, char *argv[]) {
	USED(argc, argv);

	Mouse m;
	Point prevm;
	initdraw(0,0,"Example: Mouse");
	eresized(0);
	einit(Emouse);

	/* Main loop */
	for(;;){
		m = emouse();
		if(m.buttons & 4)
			break;
		if(m.buttons & 1){
			line(screen,
				prevm.x == -1 ? m.xy : prevm,
				m.xy, Enddisc, Enddisc, 1, display->black, ZP);
			prevm = m.xy;
		}
		else{
			prevm = Pt(-1,-1);
		}
	}
}
</pre>

<h3>Plan 9 Keyboard Example</h3>

<pre>
#include &lt;u.h&gt;
#include &lt;libc.h&gt;
#include &lt;draw.h&gt;
#include &lt;event.h&gt;
#include &lt;keyboard.h&gt;

void eresized(int new) {
	if (new &&getwindow(display, Refnone) < 0)
		sysfatal("can't reattach to window");
}

void main(int argc, char *argv[]) {
	USED(argc, argv);

	Event ev;
	int e;
	initdraw(0,0,"Example: Keyboard");
	eresized(0);
	einit(Ekeyboard);

	/* Main loop */
	for (;;) {
  		e = event(&ev);
		if(e == Ekeyboard){
			print("key: %d\n", ev.kbdc);
			/* Break on escape */
			if(ev.kbdc == 27){
				print("Escaped\n");
				break;
			}
		}
	}
}
</pre>

<h3>Plan 9 Menu Example</h3>

<pre>
#include &lt;u.h&gt;
#include &lt;libc.h&gt;
#include &lt;draw.h&gt;
#include &lt;event.h&gt;

char *buttons[] = {"Option1", "Option2", "Option3", "Exit", 0};
Menu menu = {buttons};

void eresized(int new) {
	if (new &&getwindow(display, Refnone) < 0)
		sysfatal("can't reattach to window");
}

void main(int argc, char *argv[]) {
	USED(argc, argv);

	Event ev;
	int e;
	initdraw(0,0,"Example: Menu");
	eresized(0);
	einit(Emouse);

	/* Main loop */
	for (;;) {
  		e = event(&ev);
  		if ((e == Emouse) && (ev.mouse.buttons & 4)){
			if(emenuhit(3, &ev.mouse, &menu) == 0)
				print("Pressed Option 1");
			if(emenuhit(3, &ev.mouse, &menu) == 1)
				print("Pressed Option 2");
			if(emenuhit(3, &ev.mouse, &menu) == 2)
				print("Pressed Option 3");
			if(emenuhit(3, &ev.mouse, &menu) == 3)
				exits(nil);
    		}
	}
}
</pre>
<p>Found a mistake? Submit an <a href='https://github.com/XXIIVV/Oscean/edit/master/src/inc/plan9 c.htm'  target='_blank'>edit</a> to plan9 c.</p><h3>plan9 development links</h3><ul><li><b>Intro to C Programming on Plan 9</b>: http://doc.cat-v.org/plan_9/programming/c_programming_in_plan_9</li><li><b>Intro to Graphics on Plan 9</b>: http://blog.postnix.pw/2018/09/21/0/</li><li><b>Interface Tutorial</b>: https://github.com/nspool/hello-plan9</li><li><b>Graphics Docs</b>: http://man.postnix.pw/9front/2/graphics</li><li><b>Draw Docs</b>: http://man.postnix.pw/9front/2/draw</li><li><b>Audio</b>: http://nopenopenope.net/posts/audio</li></ul><p><i>incoming(1)</i>: <a href='chr9.html'>chr9</a> </p><p><i>Last update on <a href='tracker.html'>20P09</a>, edited 2 times. +11/13fh</i><code style='float:right; font-size:80%'>○○○○○●</code></p></main><footer><a href='https://creativecommons.org/licenses/by-nc-sa/4.0'><img src='../media/icon/cc.svg'/></a><a href='http://webring.xxiivv.com/'><img src='../media/icon/rotonde.svg'/></a><a href='https://merveilles.town/@neauoire'><img src='../media/icon/merveilles.svg'/></a><a href='https://github.com/neauoire'><img src='../media/icon/github.png' alt='github'/></a><span><a href='devine_lu_linvega.html'>Devine Lu Linvega</a> © 2020 — <a href='about.html'>BY-NC-SA 4.0</a></span></footer></body></html>